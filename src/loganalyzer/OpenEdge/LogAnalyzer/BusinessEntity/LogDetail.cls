 
/*------------------------------------------------------------------------
   File        : LogDetail
   Syntax      : 
   Author(s)   : isyed
   Created     : Mon Jan 01 23:20:35 EST 2018
   Notes       : 
 ----------------------------------------------------------------------*/
  
@program FILE(name="LogDetail.cls", module="AppServer").
@openapi.openedge.export FILE(type="REST", executionMode="singleton", useReturnValue="false", writeDataSetBeforeImage="false").
@progress.service.resource FILE(name="LogDetail", URI="/detail", schemaName="dsLogDetail", schemaFile="LogAnalyzer/PASOEContent/WEB-INF/openedge/OpenEdge/LogAnalyzer/Include/eLogdetail.i").

USING Progress.Lang.*.
USING OpenEdge.BusinessLogic.BusinessEntity.
USING OpenEdge.LogAnalyzer.BusinessEntity.LogDetail FROM PROPATH.
USING Progress.Json.ObjectModel.ObjectModelParser FROM PROPATH.
USING Progress.Json.ObjectModel.JsonObject FROM PROPATH.

BLOCK-LEVEL ON ERROR UNDO, THROW.

CLASS OpenEdge.LogAnalyzer.BusinessEntity.LogDetail INHERITS BusinessEntity:
    /*------------------------------------------------------------------------------
            Purpose:                                                                      
            Notes:                                                                        
    ------------------------------------------------------------------------------*/
    
    {"OpenEdge/LogAnalyzer/Include/eLogdetail.i"}
    
    DEFINE DATA-SOURCE srcLogDetail FOR logdb.LogDetail.
    DEFINE VARIABLE iSeq AS INTEGER NO-UNDO.
    
    
    
    /*------------------------------------------------------------------------------
            Purpose:                                                                      
            Notes:                                                                        
    ------------------------------------------------------------------------------*/
    CONSTRUCTOR PUBLIC LogDetail():
        
        DEFINE VARIABLE hDataSourceArray AS HANDLE    NO-UNDO EXTENT 1.
        DEFINE VARIABLE cSkipListArray   AS CHARACTER NO-UNDO EXTENT 1.
        
        SUPER (DATASET dsLogDetail:HANDLE).
        
        /* Data Source for each table in dataset. Should be in table order as defined 
            in DataSet */     
        hDataSourceArray[1] =  DATA-SOURCE srcLogDetail:HANDLE.
         
                  
        /* Skip-list entry for each table in dataset. Should be in temp-table order 
          as defined in DataSet */
        /* Each skip-list entry is a comma-separated list of field names, to be
            ignored in create stmt */
             
        cSkipListArray[1] = "".
         
         
        THIS-OBJECT:ProDataSource = hDataSourceArray.
        THIS-OBJECT:SkipList = cSkipListArray.
                 
    END CONSTRUCTOR.
        
    /*------------------------------------------------------------------------------
            Purpose:  Get one or more records, based on a filter string                                                                     
            Notes:                                                                        
    ------------------------------------------------------------------------------*/
    @openapi.openedge.export(type="REST", useReturnValue="false", writeDataSetBeforeImage="true").
    @progress.service.resourceMapping(type="REST", operation="read", URI="?filter=骈祠弪", alias="", mediaType="application/json"). 
    @openapi.openedge.method.property (name="mappingType", value="JFP").
    @openapi.openedge.method.property (name="capabilities", value="ablFilter,top,skip,id,orderBy").
   
    METHOD PUBLIC VOID ReadLogDetail(
        INPUT filter AS CHARACTER, 
        OUTPUT DATASET dsLogDetail):
            
        IF filter BEGINS "匀盼匀捎下逝迷菏菩崎祆湾翳镤ㄉ涡赵骈祠弪┊盘优南抡破乓趑田缒弭衢旌攘文膛郝猎萌由谂爱抡破乓趑田缒弭衢旌优原昧烫铝盟á疗耘噎蚁篆粕烫⒘滗射崎屐洧┊诱信液义徜尼翎ㄦ殪翦颟盼漠诱信液义徜尼翎ㄦ殪翦颟盼团匀夏团匀夏幸芍猎窒赡势衅殪焱弭栾洙晌姓骈祠弪劣萌烈撩耘药呐粕闻至疑谅膛牦镱嗅蝮弪劣镶赍泗惋溴煨狎箦蜗瘴南呐粕闻至疑谅膛牦镱镶赍泗劣鼠镱镶赍泗蜗瘴南呐粕闻至疑谅膛阕桢蝈劣萌烈撩耘蜗瘴南呐粕闻至疑谅膛柩蹂蝙劣攘文膛蜗瘴南呐粕闻至疑谅膛煺箦义痫箝糸镱劣滔巧昧蜗瘴南呐粕闻至疑谅膛槊秕铘劣晌耘桥蜗瘴南呐粕闻至疑谅膛徕炱殪翦劣萌烈撩耘蜗瘴南呐粕闻至疑谅膛殇劣萌烈撩耘晌稍闪蜗瘴南呐粕闻至疑谅膛橥狲绎黧劣晌耘桥晌稍闪蜗瘴南呐粕闻至疑谅膛橛腴鹨秣劣晌耘桥晌稍闪蜗瘴南呐粕闻至疑谅膛阆蜾弪蛮劣萌烈撩耘晌稍闪蜗瘴南瘐蜱犷屮轶糸铉溽翎磐性耘托粤绿趑田缒弭衢飚牦镱嗅蝮弪闻镶赍泗惋溴煨狎箦颞┊牦镱镶赍泗昧釉牦镱嗅蝮弪盒狎箦ㄦ殪翦颟牦镱镶赍泗┊橥狲绎黧牦镱镶赍泗呵弭深翦珏颞Ⅳ镳蜗乓蚁耶橛腴鹨秣牦镱镶赍泗呵弭深翦珏颞Ⅲ腴稷蜗乓蚁耶徕炱殪翦牦镱镶赍泗呵弭描狎徙翦颞⑨忪崎祠弪蜗乓蚁耶殇牦镱镶赍泗呵弭描狎徙翦颞㈤洧蜗乓蚁耶阆蜾弪蛮牦镱镶赍泗呵弭描狎徙翦颞矧溴蚵蜗乓蚁耶阕桢蝈⒆扰遗徕炱殪翦蜗乓蚁耶善阆蜾弪蛮匀盼南阆蜾弪蛮遗刑撩浓阆蜾弪蛮怡┊阆蜾弪蛮⑩阆蜾弪蛮蜗耘殇犷箦骈屐潴箬秕熹忮蝈盹鲥骝镯阕桢蝈犷阆蜾弪蛮阆蜾弪蛮遗刑撩浓阆蜾弪蛮⑩殇溴筱┊阆蜾弪蛮遗刑撩浓阆蜾弪蛮⑩殇┊阆蜾弪蛮遗刑撩浓阆蜾弪蛮⑩箦溴筱┊阆蜾弪蛮遗刑撩浓阆蜾弪蛮⑩箦┊盼漠煺箦义痫箝糸镱橛腴鹨秣季慨善橥狲绎黧季廖橥狲绎黧匀盼南抡破乓趑田缒弭衢旌攘文膛郝猎萌由谂橥狲绎黧盼漠盘优南善殇匀盼抡破乓趑田缒弭衢旌攘文膛郝猎萌由谂碑盘优抡破乓趑田缒弭衢旌攘文膛郝猎萌由谂爱盼漠抡破乓趑田缒弭衢旌猎粤萌牧粤酉找门牧粤酉找门篁闾镧腻翎殪喝廖奶农善阆蜾弪蛮匀盼阆蜾弪蛮阕桢蝈善阕桢蝈匀盼ㄣ阻弪阆蜾弪蛮盘优á兹乓阆蜾弪蛮┊牧粤酉找门篁闾镧腻翎殪浩商汰兹乓怒釉疑吻阕桢蝈善煺箦义痫箝糸镱匀盼南柩蹂蝙牧粤酉找门篁闾镧腻翎殪貉张屹柩蹂蝙貉张屹闲盼善殇廖殇季⒖匀盼南柩蹂蝙阂判嫌稍上苇韵蚁咨抹韵蚁咨抹殇┅盼漠盘优善橛腴鹨秣季廖橛腴鹨秣匀盼南柩蹂蝙阂判嫌稍上苇韵蚁专橛腴鹨秣螬善蜗林辽塘绿田缒弭衢匀盼柩蹂蝙呵旁闻卦ī蜗乓蚁耶盼漠槊秕铘爱遗信猎兹商蜗柩蹂蝙貉张屹掀骗盼廖槊秕铘橥狲绎黧柩蹂蝙呵旁闻卦ī蜗乓蚁耶善林辽塘绿田缒弭衢匀盼南靡帕耘趑田缒弭衢飚抡破乓孟匈田缒弭衢韵趑田缒弭衢飚劣由俏趑田缒弭衢飚殇釉疑吻ㄒ献赡ㄌ镧腻翎殪┅橛羼橛羼趑田缒弭衢飚箦橛羼盼漠槊秕铘槊秕铘碑盼漠盼漠盘优南善殇匀盼牧粤酉找门篁闾镧腻翎殪阂庞粤以蚁咨抹暴韵蚁咨è殇┅抡破乓趑田缒弭衢旌优原昧烫铝盟á疗耘噎蚁篆粕烫⒘滗射崎屐洧┊牧粤优潴田缒弭衢旌粕烫ī盼漠粕瘟烫俸抡破乓趑田缒弭衢旌呐粤萌牧粤酉找门ī盼粕瘟烫佼盼团匀夏里疱钺痖镳孱邃珏屮痫螋豉疱舰遗釉躞逡弭躜钪犰蹂舰驷祗澧黩轸迥狒嵊弭洛骘蝈身徵褰㈡犰箦┊鲤蝻珧弩螽箦蝣殂瀹蝈箫躜沐歪痧轭绋豉疱舰遗釉镳弪狒轱罱泔躅簪找山泔躅艨骈祠弪浸骈祠弪", alias="", mediaType="application/json").
    METHOD PUBLIC VOID count( INPUT filter AS CHARACTER, OUTPUT numRecs AS INTEGER):
        DEFINE VARIABLE jsonParser AS ObjectModelParser NO-UNDO.
        DEFINE VARIABLE jsonObject AS JsonObject        NO-UNDO.
        DEFINE VARIABLE ablFilter  AS CHARACTER         NO-UNDO.
        DEFINE VARIABLE cWhere     AS CHARACTER         NO-UNDO.
        DEFINE VARIABLE qh         AS HANDLE            NO-UNDO.

        IF filter BEGINS "WHERE " THEN
            cWhere = filter.
        ELSE IF filter BEGINS "匀盼南牦镱嗅蝮弪闻镶赍泗惋溴煨狎箦颞┊牦镱镶赍泗昧釉牦镱嗅蝮弪盒狎箦ㄦ殪翦颟牦镱镶赍泗┊徕炱殪翦牦镱镶赍泗呵弭描狎徙翦颞⑨忪崎祠弪蜗乓蚁耶阕桢蝈⒆扰遗徕炱殪翦虍盼漠盘优善骈祠弪闻匀盼南阵骈祠弪狍兹乓沆狨箦阕桢蝈⒆扰遗骈祠弪盼漠靡帕耘颜乓耔耔河旁抡破乓莹抡破乓田缒弭衢旌攘文膛┊耔貉张屹幸判烈浓⑿遗优膛迷帕萌田缒弭衢阕桢蝈┊耔貉张屹闲盼ī铛硪邈耔何胀遗诱淘赢盼团匀夏盼锰劣赢